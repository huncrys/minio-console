"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[4103],{64103:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var i=s(65043),a=s(89923),n=s(73216),l=s(99161),o=s(20554),r=s(64159),c=s(95109),p=s(25448),u=s(94574),x=s(33097),d=s.n(x),m=s(70579);const h=u.Ay.div((e=>{let{theme:t}=e;return{marginTop:15,table:{width:"100%",borderCollapse:"collapse","& .feature-cell":{fontWeight:600,fontSize:14,paddingLeft:15},"& .status-cell":{textAlign:"center"},"& .header-cell":{textAlign:"center"},"& tr":{height:38,"& td":{borderBottom:`1px solid ${d()(t,"borderColor","#E2E2E2")}`},"& th":{borderBottom:`2px solid ${d()(t,"borderColor","#E2E2E2")}`}},"& .indicator":{display:"flex",alignItems:"center",justifyContent:"center","& .min-icon":{height:15,width:15},"&.active":{"& .min-icon":{fill:d()(t,"signalColors.good","#4CCB92")}},"&.deactivated":{"& .min-icon":{fill:d()(t,"signalColors.danger","#C51B3F")}}}}}})),f=e=>{let{matrixData:t=[],entityName:s="",entityType:i=""}=e;const[n=[],...l]=t,o=n.map(((e,t)=>(0,m.jsx)("th",{className:"header-cell",children:e},`0${t}`))),r=l.map(((e,t)=>(0,m.jsx)("tr",{children:e.map(((e,s)=>{let i=null;return 0===s?i=e:""===e&&(i=""),!0===e?i=(0,m.jsx)(a.azJ,{className:"indicator active",children:(0,m.jsx)(a.GQ2,{})}):!1===e&&(i=(0,m.jsx)(a.azJ,{className:"indicator deactivated",children:(0,m.jsx)(a.GQ2,{})})),(0,m.jsx)("td",{className:0===s?"feature-cell":"status-cell",children:i},`${t+1}${s}`)}))},`r-${t+1}`)));return(0,m.jsxs)(h,{children:[(0,m.jsxs)(a.azJ,{sx:{marginTop:15,marginBottom:15},children:["Replication status for ",i,": ",(0,m.jsx)("strong",{children:s}),"."]}),(0,m.jsxs)("table",{children:[(0,m.jsx)("thead",{children:(0,m.jsx)("tr",{children:o})}),(0,m.jsx)("tbody",{children:r})]})]})};function g(e,t){return t?!e:""}function y(e,t,s){return Object.keys(e).find((e=>!(t[e]||{})[s]))}const j=e=>{let{entityType:t,entityValue:s}=e;return(0,m.jsxs)(a.azJ,{sx:{marginTop:"45px",display:"flex",alignItems:"center",justifyContent:"center"},children:[t,":"," ",(0,m.jsx)(a.azJ,{sx:{marginLeft:"5px",marginRight:"5px",fontWeight:600},children:s})," ","not found."]})},C=e=>{let{bucketStats:t={},sites:s={},lookupValue:i=""}=e;const a=["Tags","Policy","Quota","Retention","Encryption","Replication"],n=t[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasBucket"))return(0,m.jsx)(j,{entityType:"Bucket",entityValue:i});{const e=[];for(let t=0;t<l.length;t++)0===t&&e.push(""),e.push(s[l[t]].name);o.push(e);for(let t=0;t<a.length;t++){const e=[],i=a[t];let r="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];switch(0===a&&e.push(i),t){case 0:r=g(o.TagMismatch,o.HasTagsSet),e.push(r);break;case 1:r=g(o.PolicyMismatch,o.HasPolicySet),e.push(r);break;case 2:r=g(o.QuotaCfgMismatch,o.HasQuotaCfgSet),e.push(r);break;case 3:r=g(o.OLockConfigMismatch,o.HasOLockConfigSet),e.push(r);break;case 4:r=g(o.SSEConfigMismatch,o.HasSSECfgSet),e.push(r);break;case 5:r=g(o.ReplicationCfgMismatch,o.HasReplicationCfg),e.push(r)}}o.push(e)}}return(0,m.jsx)(f,{matrixData:o,entityName:i,entityType:"Bucket"})},b=e=>{let{policyStats:t={},sites:s={},lookupValue:i=""}=e;const a=["Policy"],n=t[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasPolicy"))return(0,m.jsx)(j,{entityType:"Policy",entityValue:i});{const e=[];for(let t=0;t<l.length;t++)0===t&&e.push(""),e.push(s[l[t]].name);o.push(e);for(let t=0;t<a.length;t++){const e=[],i=a[t];let r="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];if(0===a&&e.push(i),0===t)r=g(o.PolicyMismatch,o.HasPolicy),e.push(r)}o.push(e)}}return(0,m.jsx)(f,{matrixData:o,entityName:i,entityType:"Policy"})},S=e=>{let{groupStats:t={},sites:s={},lookupValue:i=""}=e;const a=["Info","Policy mapping"],n=t[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasGroup"))return(0,m.jsx)(j,{entityType:"Group",entityValue:i});{const e=[];for(let t=0;t<l.length;t++)0===t&&e.push(""),e.push(s[l[t]].name);o.push(e);for(let t=0;t<a.length;t++){const e=[],i=a[t];let r="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];switch(0===a&&e.push(i),t){case 0:r=g(o.GroupDescMismatch,o.HasGroup),e.push(r);break;case 1:r=g(o.PolicyMismatch,o.HasPolicyMapping),e.push(r)}}o.push(e)}}return(0,m.jsx)(f,{matrixData:o,entityName:i,entityType:"Group"})},k=e=>{let{userStats:t={},sites:s={},lookupValue:i=""}=e;const a=["Info","Policy mapping"],n=t[i]||{};if(!i)return null;const l=Object.keys(s),o=[];if(y(s,n,"HasUser"))return(0,m.jsx)(j,{entityType:"User",entityValue:i});{const e=[];for(let t=0;t<l.length;t++)0===t&&e.push(""),e.push(s[l[t]].name);o.push(e);for(let t=0;t<a.length;t++){const e=[],i=a[t];let r="";for(let a=0;a<l.length;a++){const o=n[s[l[a]].deploymentID];switch(0===a&&e.push(i),t){case 0:r=g(o.UserInfoMismatch,o.HasUser),e.push(r);break;case 1:r=g(o.PolicyMismatch,o.HasPolicyMapping),e.push(r)}}o.push(e)}}return(0,m.jsx)(f,{matrixData:o,entityName:i,entityType:"User"})};var T=s(6681);const w=()=>{const[e,t]=(0,i.useState)("bucket"),[s,n]=(0,i.useState)(""),[l,o]=(0,i.useState)({}),[r,c]=(0,i.useState)(!1),[u,x]=(0,p.A)((e=>{o(e),c(!0)}),(e=>{o({}),c(!0)})),{bucketStats:d={},sites:h={},userStats:f={},policyStats:g={},groupStats:y={}}=l||{};return(0,m.jsxs)(a.azJ,{children:[(0,m.jsxs)(a.azJ,{sx:{display:"grid",alignItems:"center",gridTemplateColumns:".7fr .9fr 1.2fr .3fr",[`@media (max-width: ${a.nmC.sm}px)`]:{gridTemplateColumns:"1fr"},[`@media (max-width: ${a.nmC.md}px)`]:{gridTemplateColumns:"1.2fr .7fr .7fr .3fr"},gap:"15px"},children:[(0,m.jsx)(a.azJ,{sx:{width:"240px",flexGrow:"0"},children:"View Replication Status for a:"}),(0,m.jsx)(a.azJ,{sx:{marginLeft:-25,[`@media (max-width: ${a.nmC.sm}px)`]:{marginLeft:0}},children:(0,m.jsx)(a.l6P,{id:"replicationEntityLookup",name:"replicationEntityLookup",onChange:e=>{t(e),c(!1)},label:"",value:e,options:[{label:"Bucket",value:"bucket"},{label:"User",value:"user"},{label:"Group",value:"group"},{label:"Policy",value:"policy"}],disabled:!1})}),(0,m.jsx)(a.azJ,{sx:{flex:2},children:(0,m.jsx)(a.cl_,{id:"replicationLookupEntityValue",name:"replicationLookupEntityValue",onChange:e=>{n(e.target.value),c(!1)},placeholder:`test-${e}`,label:"",value:s})}),(0,m.jsx)(a.azJ,{sx:{maxWidth:"80px"},children:(0,m.jsx)(T.A,{tooltip:"View across sites",children:(0,m.jsx)(a.$nd,{id:"view-across-sites",type:"button",onClick:()=>{!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";c(!1),e&&t&&x("GET",`api/v1/admin/site-replication/status?buckets=false&entityType=${e}&entityValue=${t}&groups=false&policies=false&users=false`)}(e,s)},label:"View",icon:(0,m.jsx)(a.pHQ,{}),collapseOnSmall:!1,disabled:!s||!e})})})]}),u?(0,m.jsx)(a.xA9,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:45},children:(0,m.jsx)(a.aHM,{style:{width:25,height:25}})}):null,r?(0,m.jsxs)(a.azJ,{children:[!u&&"bucket"===e&&s?(0,m.jsx)(C,{bucketStats:d,sites:h,lookupValue:s}):null,!u&&"user"===e&&s?(0,m.jsx)(k,{userStats:f,sites:h,lookupValue:s}):null,!u&&"group"===e&&s?(0,m.jsx)(S,{groupStats:y,sites:h,lookupValue:s}):null,!u&&"policy"===e&&s?(0,m.jsx)(b,{policyStats:g,sites:h,lookupValue:s}):null]}):null]})};var z=s(48793),v=s(88617),J=s(56629),P=s(53518);const V=e=>{var t;let{maxValue:s=0,entityStatObj:i={},entityTextPlural:n="",icon:l=null}=e;const o=null===(t=Object.keys(i||{}))||void 0===t?void 0:t.length;return(0,m.jsx)(a.azJ,{withBorders:!0,sx:{padding:"25px",[`@media (min-width: ${a.nmC.sm}px)`]:{maxWidth:"100%"}},children:(0,m.jsx)(c.A,{icon:l,onlineCount:s,offlineCount:o,okStatusText:"Synced",notOkStatusText:"Failed",label:n})})},I=()=>{const e=(0,n.Zp)(),[t,s]=(0,i.useState)({}),[c,p]=(0,i.useState)(!1),{maxBuckets:u=0,bucketStats:x={},maxGroups:d=0,groupStats:h={},maxUsers:f=0,userStats:g={},maxPolicies:y=0,policyStats:j={}}=t||{},C=()=>{p(!0),J.F.admin.getSiteReplicationStatus({buckets:!0,groups:!0,policies:!0,users:!0}).then((e=>{s(e.data)})).catch((e=>{s({}),b((0,r.C9)((0,P.S)(e.error)))})).finally((()=>p(!1)))};(0,i.useEffect)((()=>{C()}),[]);const b=(0,o.jL)();return(0,i.useEffect)((()=>{b((0,r.ph)("replication_status"))}),[]),(0,m.jsxs)(i.Fragment,{children:[(0,m.jsx)(z.A,{label:(0,m.jsx)(a.EGL,{label:"Site Replication",onClick:()=>e(l.zZ.SITE_REPLICATION)}),actions:(0,m.jsx)(v.A,{})}),(0,m.jsxs)(a.Mxu,{children:[(0,m.jsx)(a._xt,{actions:(0,m.jsx)(i.Fragment,{children:(0,m.jsx)(T.A,{tooltip:"Refresh",children:(0,m.jsx)(a.$nd,{id:"refresh",onClick:()=>{C()},label:"Refresh",icon:(0,m.jsx)(a.fNY,{}),variant:"regular",collapseOnSmall:!1})})}),separator:!0,children:"Replication status from all Sites"}),c?(0,m.jsx)(a.xA9,{item:!0,xs:12,sx:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:45},children:(0,m.jsx)(a.aHM,{style:{width:25,height:25}})}):(0,m.jsxs)(a.azJ,{sx:{display:"grid",marginTop:"25px",gridTemplateColumns:"1fr 1fr 1fr 1fr",[`@media (max-width: ${a.nmC.md}px)`]:{gridTemplateColumns:"1fr 1fr"},[`@media (max-width: ${a.nmC.sm}px)`]:{gridTemplateColumns:"1fr"},gap:"30px"},children:[(0,m.jsx)(V,{entityStatObj:x,entityTextPlural:"Buckets",maxValue:u,icon:(0,m.jsx)(a.brV,{})}),(0,m.jsx)(V,{entityStatObj:g,entityTextPlural:"Users",maxValue:f,icon:(0,m.jsx)(a.c2u,{})}),(0,m.jsx)(V,{entityStatObj:h,entityTextPlural:"Groups",maxValue:d,icon:(0,m.jsx)(a.YXz,{})}),(0,m.jsx)(V,{entityStatObj:j,entityTextPlural:"Policies",maxValue:y,icon:(0,m.jsx)(a.n$X,{})})]}),(0,m.jsx)(a.azJ,{withBorders:!0,sx:{minHeight:450,[`@media (max-width: ${a.nmC.sm}px)`]:{minHeight:250},marginTop:"25px",padding:"25px"},children:(0,m.jsx)(w,{})})]})]})}},95109:(e,t,s)=>{s.d(t,{A:()=>c});s(65043);var i=s(94574),a=s(33097),n=s.n(a),l=s(89923),o=s(70579);const r=i.Ay.div((e=>{let{theme:t}=e;return{fontFamily:"Inter,sans-serif",maxWidth:"321px",display:"flex",marginLeft:"auto",marginRight:"auto",cursor:"default",color:n()(t,"signalColors.main","#07193E"),"& .mainBox":{flex:1,display:"flex",padding:"0 8px 0 8px",[`@media (max-width: ${l.nmC.sm}px)`]:{padding:"0 10px 0 10px"},"& .indicatorIcon":{width:"20px",height:"20px",marginTop:"8px",maxWidth:"26px","& .min-icon":{width:"16px",height:"16px"}},"& .indicatorContainer":{flex:1,display:"flex",flexFlow:"column","& .indicatorLabel":{fontSize:"16px",fontWeight:600},"& .counterIndicator":{display:"flex",alignItems:"center",gap:"5px",justifyContent:"space-between",paddingBottom:0,fontSize:"55px",[`@media (max-width: ${l.nmC.sm}px)`]:{paddingBottom:10,fontSize:"35px"},[`@media (max-width: ${l.nmC.lg}px)`]:{fontSize:"45px"},[`@media (max-width: ${l.nmC.xl}px)`]:{fontSize:"50px"},flexFlow:"row",fontWeight:600,"& .stat-text":{color:n()(t,"mutedText","#87888D"),fontSize:"12px",marginTop:"8px"},"& .stat-value":{textAlign:"center",height:"50px"},"& .min-icon":{marginRight:"8px",marginTop:"8px",height:"10px",width:"10px"}},"& .onlineCounter":{display:"flex",alignItems:"center",marginTop:"5px","& .min-icon":{fill:n()(t,"signalColors.good","#4CCB92")}},"& .offlineCount":{display:"flex",alignItems:"center",marginTop:"8px","& .min-icon":{fill:n()(t,"signalColors.danger","#C51B3F")}}}}}})),c=e=>{let{onlineCount:t=0,offlineCount:s=0,icon:i=null,label:a="",okStatusText:n="Online",notOkStatusText:c="Offline"}=e;return(0,o.jsx)(r,{children:(0,o.jsxs)(l.azJ,{className:"mainBox",children:[(0,o.jsxs)(l.azJ,{className:"indicatorContainer",children:[(0,o.jsx)(l.azJ,{className:"indicatorLabel",children:a}),(0,o.jsxs)(l.azJ,{className:"counterIndicator",children:[(0,o.jsxs)(l.azJ,{children:[(0,o.jsx)(l.azJ,{className:"stat-value",children:t}),(0,o.jsxs)(l.azJ,{className:"onlineCounter",children:[(0,o.jsx)(l.GQ2,{}),(0,o.jsx)("div",{className:"stat-text",children:n})]})]}),(0,o.jsxs)(l.azJ,{children:[(0,o.jsx)(l.azJ,{className:"stat-value",children:s}),(0,o.jsxs)(l.azJ,{className:"offlineCount",children:[(0,o.jsx)(l.GQ2,{})," ",(0,o.jsx)("div",{className:"stat-text",children:c})]})]})]})]}),(0,o.jsx)(l.azJ,{className:"indicatorIcon",children:i})]})})}}}]);
//# sourceMappingURL=4103.d1c6c7e0.chunk.js.map