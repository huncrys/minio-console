{"version":3,"file":"static/js/258.1442e3bb.chunk.js","mappings":"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","sources":["common/api/index.ts","common/utils.ts","screens/LoginPage/LoginCallback.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport request from \"superagent\";\nimport get from \"lodash/get\";\nimport { clearSession } from \"../utils\";\nimport { ErrorResponseHandler } from \"../types\";\nimport { baseUrl } from \"../../history\";\n\ntype RequestHeaders = { [name: string]: string };\n\nexport class API {\n  invoke(method: string, url: string, data?: object, headers?: RequestHeaders) {\n    let targetURL = url;\n    if (targetURL[0] === \"/\") {\n      targetURL = targetURL.slice(1);\n    }\n    let req = request(method, targetURL);\n\n    if (headers) {\n      for (let k in headers) {\n        req.set(k, headers[k]);\n      }\n    }\n\n    return req\n      .send(data)\n      .then((res) => res.body)\n      .catch((err) => {\n        // if we get unauthorized and we are not doing login, kick out the user\n        if (\n          err.status === 401 &&\n          localStorage.getItem(\"userLoggedIn\") &&\n          !targetURL.includes(\"api/v1/login\")\n        ) {\n          if (window.location.pathname !== \"/\") {\n            localStorage.setItem(\"redirect-path\", window.location.pathname);\n          }\n          clearSession();\n          // Refresh the whole page to ensure cache is clear\n          // and we dont end on an infinite loop\n          window.location.href = `${baseUrl}login`;\n          return;\n        }\n\n        return this.onError(err);\n      });\n  }\n\n  onError(err: any) {\n    if (err.status) {\n      const errMessage = get(\n        err.response,\n        \"body.message\",\n        `Error ${err.status.toString()}`,\n      );\n\n      let detailedMessage = get(err.response, \"body.detailedMessage\", \"\");\n\n      if (errMessage === detailedMessage) {\n        detailedMessage = \"\";\n      }\n\n      const capMessage =\n        errMessage.charAt(0).toUpperCase() + errMessage.slice(1);\n      const capDetailed =\n        detailedMessage.charAt(0).toUpperCase() + detailedMessage.slice(1);\n\n      const throwMessage: ErrorResponseHandler = {\n        errorMessage: capMessage,\n        detailedError: capDetailed,\n        statusCode: err.status,\n      };\n\n      return Promise.reject(throwMessage);\n    } else {\n      clearSession();\n      window.location.href = `${baseUrl}login`;\n    }\n  }\n}\n\nconst api = new API();\nexport default api;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport storage from \"local-storage-fallback\";\nimport { IErasureCodeCalc, IStorageFactors } from \"./types\";\n\nimport get from \"lodash/get\";\n\nconst minMemReq = 2147483648; // Minimal Memory required for MinIO in bytes\n\nconst units = [\"B\", \"KiB\", \"MiB\", \"GiB\", \"TiB\", \"PiB\", \"EiB\", \"ZiB\", \"YiB\"];\nconst k8sUnits = [\"Ki\", \"Mi\", \"Gi\", \"Ti\", \"Pi\", \"Ei\"];\nconst k8sCalcUnits = [\"B\", ...k8sUnits];\n\nexport const niceBytes = (x: string, showK8sUnits: boolean = false) => {\n  let n = parseInt(x, 10) || 0;\n\n  return niceBytesInt(n, showK8sUnits);\n};\n\nexport const niceBytesInt = (n: number, showK8sUnits: boolean = false) => {\n  let l = 0;\n\n  while (n >= 1024 && ++l) {\n    n = n / 1024;\n  }\n  // include a decimal point and a tenths-place digit if presenting\n  // less than ten of KB or greater units\n  const k8sUnitsN = [\"B\", ...k8sUnits];\n  return n.toFixed(1) + \" \" + (showK8sUnits ? k8sUnitsN[l] : units[l]);\n};\n\nconst deleteCookie = (name: string) => {\n  document.cookie = name + \"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;\";\n};\n\nexport const clearSession = () => {\n  storage.removeItem(\"token\");\n  storage.removeItem(\"auth-state\");\n  deleteCookie(\"token\");\n  deleteCookie(\"idp-refresh-token\");\n};\n\n//getBytes, converts from a value and a unit from units array to bytes as a string\nexport const getBytes = (\n  value: string,\n  unit: string,\n  fromk8s: boolean = false,\n): string => {\n  return getBytesNumber(value, unit, fromk8s).toString(10);\n};\n\n//getBytesNumber, converts from a value and a unit from units array to bytes\nconst getBytesNumber = (\n  value: string,\n  unit: string,\n  fromk8s: boolean = false,\n): number => {\n  const vl: number = parseFloat(value);\n\n  const unitsTake = fromk8s ? k8sCalcUnits : units;\n\n  const powFactor = unitsTake.findIndex((element) => element === unit);\n\n  if (powFactor === -1) {\n    return 0;\n  }\n  const factor = Math.pow(1024, powFactor);\n  const total = vl * factor;\n\n  return total;\n};\n\nexport const setMemoryResource = (\n  memorySize: number,\n  capacitySize: string,\n  maxMemorySize: number,\n) => {\n  // value always comes as Gi\n  const requestedSizeBytes = getBytes(memorySize.toString(10), \"Gi\", true);\n  const memReqSize = parseInt(requestedSizeBytes, 10);\n  if (maxMemorySize === 0) {\n    return {\n      error: \"There is no memory available for the selected number of nodes\",\n      request: 0,\n      limit: 0,\n    };\n  }\n\n  if (maxMemorySize < minMemReq) {\n    return {\n      error: \"There are not enough memory resources available\",\n      request: 0,\n      limit: 0,\n    };\n  }\n\n  if (memReqSize < minMemReq) {\n    return {\n      error: \"The requested memory size must be greater than 2Gi\",\n      request: 0,\n      limit: 0,\n    };\n  }\n  if (memReqSize > maxMemorySize) {\n    return {\n      error:\n        \"The requested memory is greater than the max available memory for the selected number of nodes\",\n      request: 0,\n      limit: 0,\n    };\n  }\n\n  const capSize = parseInt(capacitySize, 10);\n  let memLimitSize = memReqSize;\n  // set memory limit based on the capacitySize\n  // if capacity size is lower than 1TiB we use the limit equal to request\n  if (capSize >= parseInt(getBytes(\"1\", \"Pi\", true), 10)) {\n    memLimitSize = Math.max(\n      memReqSize,\n      parseInt(getBytes(\"64\", \"Gi\", true), 10),\n    );\n  } else if (capSize >= parseInt(getBytes(\"100\", \"Ti\"), 10)) {\n    memLimitSize = Math.max(\n      memReqSize,\n      parseInt(getBytes(\"32\", \"Gi\", true), 10),\n    );\n  } else if (capSize >= parseInt(getBytes(\"10\", \"Ti\"), 10)) {\n    memLimitSize = Math.max(\n      memReqSize,\n      parseInt(getBytes(\"16\", \"Gi\", true), 10),\n    );\n  } else if (capSize >= parseInt(getBytes(\"1\", \"Ti\"), 10)) {\n    memLimitSize = Math.max(\n      memReqSize,\n      parseInt(getBytes(\"8\", \"Gi\", true), 10),\n    );\n  }\n\n  return {\n    error: \"\",\n    request: memReqSize,\n    limit: memLimitSize,\n  };\n};\n\n// Erasure Code Parity Calc\nexport const erasureCodeCalc = (\n  parityValidValues: string[],\n  totalDisks: number,\n  pvSize: number,\n  totalNodes: number,\n): IErasureCodeCalc => {\n  // Parity Values is empty\n  if (parityValidValues.length < 1) {\n    return {\n      error: 1,\n      defaultEC: \"\",\n      erasureCodeSet: 0,\n      maxEC: \"\",\n      rawCapacity: \"0\",\n      storageFactors: [],\n    };\n  }\n\n  const totalStorage = totalDisks * pvSize;\n  const maxEC = parityValidValues[0];\n  const maxParityNumber = parseInt(maxEC.split(\":\")[1], 10);\n\n  const erasureStripeSet = maxParityNumber * 2; // ESS is calculated by multiplying maximum parity by two.\n\n  const storageFactors: IStorageFactors[] = parityValidValues.map(\n    (currentParity) => {\n      const parityNumber = parseInt(currentParity.split(\":\")[1], 10);\n      const storageFactor =\n        erasureStripeSet / (erasureStripeSet - parityNumber);\n\n      const maxCapacity = Math.floor(totalStorage / storageFactor);\n      const maxTolerations =\n        totalDisks - Math.floor(totalDisks / storageFactor);\n      return {\n        erasureCode: currentParity,\n        storageFactor,\n        maxCapacity: maxCapacity.toString(10),\n        maxFailureTolerations: maxTolerations,\n      };\n    },\n  );\n\n  let defaultEC = maxEC;\n\n  const fourVar = parityValidValues.find((element) => element === \"EC:4\");\n\n  if (fourVar) {\n    defaultEC = \"EC:4\";\n  }\n\n  return {\n    error: 0,\n    storageFactors,\n    maxEC,\n    rawCapacity: totalStorage.toString(10),\n    erasureCodeSet: erasureStripeSet,\n    defaultEC,\n  };\n};\n\n// 92400 seconds -> 1 day, 1 hour, 40 minutes.\nexport const niceTimeFromSeconds = (seconds: number): string => {\n  const days = Math.floor(seconds / (3600 * 24));\n  const hours = Math.floor((seconds % (3600 * 24)) / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  const remainingSeconds = seconds % 60;\n\n  const parts = [];\n\n  if (days > 0) {\n    parts.push(`${days} day${days !== 1 ? \"s\" : \"\"}`);\n  }\n\n  if (hours > 0) {\n    parts.push(`${hours} hour${hours !== 1 ? \"s\" : \"\"}`);\n  }\n\n  if (minutes > 0) {\n    parts.push(`${minutes} minute${minutes !== 1 ? \"s\" : \"\"}`);\n  }\n\n  if (remainingSeconds > 0) {\n    parts.push(\n      `${remainingSeconds} second${remainingSeconds !== 1 ? \"s\" : \"\"}`,\n    );\n  }\n\n  return parts.join(\" and \");\n};\n\n// niceDaysInt returns the string in the max unit found e.g. 92400 seconds -> 1 day\nexport const niceDaysInt = (seconds: number, timeVariant: string = \"s\") => {\n  switch (timeVariant) {\n    case \"ns\":\n      seconds = Math.floor(seconds * 0.000000001);\n      break;\n    case \"ms\":\n      seconds = Math.floor(seconds * 0.001);\n      break;\n    default:\n  }\n\n  const days = Math.floor(seconds / (3600 * 24));\n\n  seconds -= days * 3600 * 24;\n  const hours = Math.floor(seconds / 3600);\n  seconds -= hours * 3600;\n  const minutes = Math.floor(seconds / 60);\n  seconds -= minutes * 60;\n\n  if (days > 365) {\n    const years = days / 365;\n    return `${years} year${Math.floor(years) === 1 ? \"\" : \"s\"}`;\n  }\n\n  if (days > 30) {\n    const months = Math.floor(days / 30);\n    const diffDays = days - months * 30;\n\n    return `${months} month${Math.floor(months) === 1 ? \"\" : \"s\"} ${\n      diffDays > 0 ? `${diffDays} day${diffDays > 1 ? \"s\" : \"\"}` : \"\"\n    }`;\n  }\n\n  if (days >= 7 && days <= 30) {\n    const weeks = Math.floor(days / 7);\n\n    return `${Math.floor(weeks)} week${weeks === 1 ? \"\" : \"s\"}`;\n  }\n\n  if (days >= 1 && days <= 6) {\n    return `${days} day${days > 1 ? \"s\" : \"\"}`;\n  }\n\n  return `${hours >= 1 ? `${hours} hour${hours > 1 ? \"s\" : \"\"}` : \"\"} ${\n    minutes >= 1 && hours === 0\n      ? `${minutes} minute${minutes > 1 ? \"s\" : \"\"}`\n      : \"\"\n  } ${\n    seconds >= 1 && minutes === 0 && hours === 0\n      ? `${seconds} second${seconds > 1 ? \"s\" : \"\"}`\n      : \"\"\n  }`;\n};\n\nexport const getClientOS = (): string => {\n  const getPlatform = get(window.navigator, \"platform\", \"undefined\");\n\n  if (!getPlatform) {\n    return \"undefined\";\n  }\n\n  return getPlatform;\n};\n\n// replaces bad unicode characters\nexport const replaceUnicodeChar = (inputString: string): string => {\n  let unicodeChar = \"\\u202E\";\n  return inputString.split(unicodeChar).join(\"<�202e>\");\n};\n\n// unescaped characters might throw error like '%'\nexport const safeDecodeURIComponent = (value: any) => {\n  try {\n    return decodeURIComponent(value);\n  } catch (err) {\n    return value;\n  }\n};\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useNavigate } from \"react-router-dom\";\nimport api from \"../../common/api\";\nimport { baseUrl } from \"../../history\";\nimport { Box, Button, LoginWrapper, WarnIcon } from \"mds\";\nimport { getLogoApplicationVariant, getLogoVar } from \"../../config\";\nimport get from \"lodash/get\";\n\nconst CallBackContainer = styled.div(({ theme }) => ({\n  \"& .errorDescription\": {\n    fontStyle: \"italic\",\n    transition: \"all .2s ease-in-out\",\n    padding: \"0 15px\",\n    marginTop: 5,\n    overflow: \"auto\",\n  },\n  \"& .errorLabel\": {\n    color: get(theme, \"fontColor\", \"#000\"),\n    fontSize: 18,\n    fontWeight: \"bold\",\n    marginLeft: 5,\n  },\n  \"& .simpleError\": {\n    marginTop: 5,\n    padding: \"2px 5px\",\n    fontSize: 16,\n    color: get(theme, \"fontColor\", \"#000\"),\n  },\n  \"& .messageIcon\": {\n    color: get(theme, \"signalColors.danger\", \"#C72C48\"),\n    display: \"flex\",\n    \"& svg\": {\n      width: 32,\n      height: 32,\n    },\n  },\n  \"& .errorTitle\": {\n    display: \"flex\",\n    alignItems: \"center\",\n    borderBottom: 15,\n  },\n}));\n\nconst LoginCallback = () => {\n  const navigate = useNavigate();\n\n  const [error, setError] = useState<string>(\"\");\n  const [errorDescription, setErrorDescription] = useState<string>(\"\");\n  const [loading, setLoading] = useState<boolean>(true);\n\n  useEffect(() => {\n    if (loading) {\n      const queryString = window.location.search;\n      const urlParams = new URLSearchParams(queryString);\n      const code = urlParams.get(\"code\");\n      const state = urlParams.get(\"state\");\n      const error = urlParams.get(\"error\");\n      const errorDescription = urlParams.get(\"errorDescription\");\n      if (error || errorDescription) {\n        setError(error || \"\");\n        setErrorDescription(errorDescription || \"\");\n        setLoading(false);\n      } else {\n        api\n          .invoke(\"POST\", \"/api/v1/login/oauth2/auth\", { code, state })\n          .then(() => {\n            // We push to history the new URL.\n            let targetPath = \"/\";\n            if (\n              localStorage.getItem(\"redirect-path\") &&\n              localStorage.getItem(\"redirect-path\") !== \"\"\n            ) {\n              targetPath = `${localStorage.getItem(\"redirect-path\")}`;\n              localStorage.setItem(\"redirect-path\", \"\");\n            }\n            if (state) {\n              localStorage.setItem(\"auth-state\", state);\n            }\n            setLoading(false);\n            navigate(targetPath);\n          })\n          .catch((error) => {\n            setError(error.errorMessage);\n            setErrorDescription(error.detailedError);\n            setLoading(false);\n          });\n      }\n    }\n  }, [loading, navigate]);\n  return error !== \"\" || errorDescription !== \"\" ? (\n    <Fragment>\n      <LoginWrapper\n        logoProps={{\n          applicationName: getLogoApplicationVariant(),\n          subVariant: getLogoVar(),\n        }}\n        form={\n          <CallBackContainer>\n            <div className={\"errorTitle\"}>\n              <span className={\"messageIcon\"}>\n                <WarnIcon />\n              </span>\n              <span className={\"errorLabel\"}>Error from IDP</span>\n            </div>\n            <div className={\"simpleError\"}>{error}</div>\n            <Box className={\"errorDescription\"}>{errorDescription}</Box>\n            <Button\n              id={\"back-to-login\"}\n              onClick={() => {\n                window.location.href = `${baseUrl}login`;\n              }}\n              type=\"submit\"\n              variant=\"callAction\"\n              fullWidth\n            >\n              Back to Login\n            </Button>\n          </CallBackContainer>\n        }\n        promoHeader={\n          <span style={{ fontSize: 28 }}>High-Performance Object Store</span>\n        }\n        promoInfo={\n          <span style={{ fontSize: 14, lineHeight: 1 }}>\n            MinIO is a cloud-native object store built to run on any\n            infrastructure - public, private or edge clouds. Primary use cases\n            include data lakes, databases, AI/ML, SaaS applications and fast\n            backup & recovery. MinIO is dual licensed under GNU AGPL v3 and\n            commercial license. To learn more, visit{\" \"}\n            <a href={\"https://min.io/?ref=con\"} target=\"_blank\" rel=\"noopener\">\n              www.min.io\n            </a>\n            .\n          </span>\n        }\n        backgroundAnimation={false}\n      />\n    </Fragment>\n  ) : null;\n};\n\nexport default LoginCallback;\n"],"names":["invoke","method","url","data","headers","targetURL","slice","req","request","k","set","send","then","res","body","catch","err","status","localStorage","getItem","includes","window","location","pathname","setItem","clearSession","href","baseUrl","this","onError","errMessage","get","response","toString","detailedMessage","throwMessage","errorMessage","charAt","toUpperCase","detailedError","statusCode","Promise","reject","units","k8sUnits","niceBytes","x","showK8sUnits","arguments","length","undefined","n","parseInt","niceBytesInt","l","k8sUnitsN","toFixed","deleteCookie","name","document","cookie","storage","removeItem","niceTimeFromSeconds","seconds","days","Math","floor","hours","minutes","remainingSeconds","parts","push","join","niceDaysInt","years","months","diffDays","weeks","getClientOS","getPlatform","navigator","replaceUnicodeChar","inputString","split","safeDecodeURIComponent","value","decodeURIComponent","CallBackContainer","styled","div","_ref","theme","fontStyle","transition","padding","marginTop","overflow","color","fontSize","fontWeight","marginLeft","display","width","height","alignItems","borderBottom","LoginCallback","navigate","useNavigate","error","setError","useState","errorDescription","setErrorDescription","loading","setLoading","useEffect","queryString","search","urlParams","URLSearchParams","code","state","api","targetPath","_jsx","Fragment","children","LoginWrapper","logoProps","applicationName","getLogoApplicationVariant","subVariant","getLogoVar","form","_jsxs","className","WarnIcon","Box","Button","id","onClick","type","variant","fullWidth","promoHeader","style","promoInfo","lineHeight","target","rel","backgroundAnimation"],"sourceRoot":""}